<!-- app/views/products/index.html.erb -->

<!-- The container for the entire page-->
<div class="product-page-container">

  <!-- The container for the title and import button-->
  <div class="products-header">
    <h1 class="product-title">All your products:</h1>
    <%= button_to "Import product(s)", "#", method: :get, class: "import-btn" %>
  </div>

  <!-- Search bar -->
  <div class="product-search-wrapper">
    <%= form_with url: products_path, method: :get, local: true, class: "product-search-form" do %>
      <%= text_field_tag :query, params[:query], placeholder: "Search products...", class: "product-search-input" %>
      <%= submit_tag "Search", class: "product-search-button" %>
    <% end %>
  </div>

  <!-- Everything related to the table -->
  <table class="products-table">
    <thead class="products-table-head">
      <tr>
        <th class="products-table-title">Name</th>
        <th class="products-table-title">Supplier</th>
        <th class="products-table-title">Category</th>
        <th class="products-table-title">Current price/unit</th>
        <th class="products-table-title">Contract end date</th>
        <th class="products-table-title">Last month volume</th>
        <th class="products-table-title">Status</th>
        <th class="products-table-title">Actions</th>
      </tr>
    </thead>

    <tbody class="products-table-body">
      <% @products.each do |product| %>
        <tr class="products-line">
          <td class="products-line-text">
            <%= link_to product.name,
                        product_path(product),
                        class: "hover:underline text-blue-600" %>
          </td>

          <td class="products-line-text"><%= product.category %></td>
          <td class="products-line-text"><%= number_to_currency(product.current_price) %></td>
          <td class="products-line-text"><%= product.contract_end_date.strftime("%b %d, %Y") %></td>
          <td class="products-line-text"><%= product.last_month_volume %></td>
          <td class="products-line-text">
            <span class="status <%= product.status.downcase.tr(' ', '_') %>">
              <%= product.status.capitalize %>
            </span>
          </td>
          <td class="products-line-text">
            <%= link_to "Renegotiate",
                        new_product_renegotiation_path(product),
                        class: "renegotiate-btn" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
