<!-- The container for the entire page-->
<div class="product-page-container">

  <div class="wrapper-that-freezes-things">
    <!-- The container for the title and import button-->
    <div class="products-header">
      <h1 class="product-title">All your products:</h1>
      <%= button_to "Import product(s)", "#", method: :get, class: "import-btn" %>
    </div>

    <!-- Search bar -->
    <div class="product-search-wrapper">
      <%= form_with url: products_path, method: :get, local: true, class: "product-search-form" do %>
        <%= text_field_tag :query, params[:query], placeholder: "Search for a supplier, a category...", class: "product-search-input" %>
        <%= submit_tag "Search", class: "product-search-button" %>
      <% end %>
    </div>
  </div>

  <!-- Everything related to the table -->
  <div class="table-scroll-wrapper"> <!-- This wrapper is used to make it sticky / frozen at the top -->
    <table class="products-table">
      <!-- First row -->
      <thead class="products-table-head">
        <tr>
          <th class="products-table-title"><%= sort_link("name", "Name") %></th>
          <th class="products-table-title"><%= sort_link("supplier", "Supplier") %></th>
          <th class="products-table-title"><%= sort_link("category", "Category") %></th>
          <th class="products-table-title"><%= sort_link("price", "Current price/unit") %></th>
          <th class="products-table-title"><%= sort_link("contract_end", "Contract end date") %></th>
          <th class="products-table-title"><%= sort_link("volume", "Last month volume") %></th>
          <th class="products-table-title"><%= sort_link("status", "Status") %></th>
          <th class="products-table-title">Actions</th> <!-- No sorting here -->
        </tr>
      </thead>

      <!-- All the rows below ; each row will be clickable and linking to Mal's SHOW page -->
      <tbody class="products-table-body">
        <% @products.each do |product| %>
          <tr class="products-line">
            <td class="products-line-text"><%= product.name %></td>
            <td class="products-line-text"><%= product.supplier.company_name %></td>
            <td class="products-line-text"><%= product.category %></td>
            <td class="products-line-text"><%= product.current_price %></td>
            <td class="products-line-text"><%= product.contract_end_date.strftime("%b %d, %Y")  %></td>
            <td class="products-line-text"><%= product.last_month_volume %></td>
            <td class="products-line-text">
              <!-- With the line below it automatically assign the class depending on the status eg. ongoing, done, pending etc-->
              <span class="status <%= product.status.downcase.tr(' ', '_') %>">
                <%= product.status.capitalize %>
              </span>
            </td>
            <!-- Renegotiate button below to be linked to the renegotiate confirmation page with price buckets -->
            <td class="products-line-text">
              <button type="submit" class="renegotiate-btn">
                Renegotiate
              </button>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
